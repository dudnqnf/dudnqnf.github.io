---
layout: post
title: "ML_note #CNN-1(미완성)"
date: 2017-12-22
excerpt: "Machine Learning"
tags:
- Deep Learning
comments: true
---
# Convolutional Neural Network(CNN)

#### 개요
- Convolution : 합성곱, ~~대단히 복잡한 것(네이버사전)~~
- 이미지 인식 기술 중 제일 좋은 성과를 보이는 알고리즘

#### 기존 알고리즘의 문제점
- 모든 픽셀을 다 교육하려니까 사진의 픽셀 수가 너무 많음

- 기본 아이디어
  - 사람의 시각적 인식은 수용영역과 추상화라는 개념을 통해서 간소화 됨

- 수용영역
  - 사람의 수용영역 = 사람의 초점
  - CNN의 수용영역 = 사진의 특정 부분(필터의 크기)

- 추상화
  - 사람의 추상화 = 사람의 얼굴을 보면 픽셀단위로 기억하지 않고 대충 그렇게 생긴 얼굴이라고 추상화하여 기억
  - CNN의 추상화 = 사진의 특정 부분 * 필터 (합성곱해서 나온 결과 사진, 뿌옇게 된 사진, 특징만 남은 사진)을 기억
  - 필터 = 특징을 잡아내 주는 역활
  - 모든 픽셀 데이터를 순간순간 마다 다 기억하지 않아도 됨

#### 용어 개념
- picture : 10 * 10 픽셀의 그림(sample)
- filter : 3 * 3 행렬 (여러가지 형태가 나올 수 있음)
- stride : 필터를 한번에 몇 칸씩 옮길지 (1로 가정)

#### 기존 NN으로의 해석
- 그림에서 필터링 되는 각각의 부분들 = X
- 필터 = W
- Y = WX 모델

#### 전체 순서
- 첫번쨰 필터셋(W1, W2, ... , W6) 6개
- W1필터로 왼쪽 위부터 순서대로 한 칸씩 옮기며 값 생성(W1X1, W1X2, W1X3, ...)
- 100번 반복하여 10 * 10 행렬 생성(layer 하나 생성)
- filter를 변경하여 또 다른 layer생성(W2X1, W2X2, W2X3, ...)
- 만약 filter가 6개 라면 10 * 10 * 6(depth) 짜리 행렬 생성 -> 1차 추상화된 그림
- 추상화된 그림을 두번째 필터셋으로 교육
- ...
- 마지막 필터셋에는 relu대신 softmax함수 사용

#### 추가
- relu(WX)를 각각에 넣어주면 더 좋음
- 중간중간 pooling 해주는 것이 좋음
- pooling = sampling = 그림을 n등분 하여 각 구역의 최고값을 추출해서 만듬
- 축소된 n * n 행렬이 나올것
- 아무튼 마지막에 나온 행렬을 softmax함수로 꺼내서 어느것인지 예측하고 update

#### 직관적으로 이해하기
- 전체적 관점 : 그림을 필터링 -> 추상화된 그림
- 세부적 관점 : 그림의 각각의 조각을 필터링한 뒤 합친 그림 -> 추상화된 그림

#### 중요한 점
- 각 조각의 크기는 그대로 이나 depth가 계속 변화(filter가 몇개냐에 따라)
- 그림의 depth = filter의 depth(depth = 한번에 넣어주는 그림의 개수)
- WX 보다 relu(WX)가 더 효과가 더 좋음
- pooling 이용시 효과가 더 좋음 : 구역의 크기(n * n)을 정해서 그림을 등분한 뒤 각각의 구역의 최대값만을 추린 행렬(=sampling)
- conv시 padding값을 주지 않으면 추상화된 그림은 작아짐


#### 질문
- 그림 또는 필터의 depth는 어떤 의미가 있는가?
- 그림도 3차원이고 필터도 3차원인데 어떻게 행렬곱을 하는가?

> 김성훈 교수님의 온라인 강의 및 논문 참고
